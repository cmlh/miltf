MILTF
=====
Mtgx & Ioc Load & Transform for netForensic:
- Search recursively for IOC and MTGX (Paterva Maltego/Casefile) file from a configured path
- Extract IP and FQDN information from located files
- Research, listing and comparaison functions

The goal is to compare an input (string or file) with others files on the analyst computer or remote server. If they are match, MILTF do not give much information. It returns minimum information and where the matched files are stored. The analyst then can find its matched files and review it. It has to be considered as a kind of 'index', and not an investigation or decision support script.

Improvment:
MILTF is dropped here. It reply to some needs I'd to face and it is one possible answer. I do not really plan to maintain it or do not promisse to add new functionnalities or work on it or publish following work.
Some possible issues/improvments:
- I'm not really sure about the --exclude (-e) whitelisting efficiency
- Module: gps_* scripts can be combine in one
- MTGX Extraction: is read as text file because lazy, parse it as XML would be cleaner and faster
- Module: filer script's methods can be combined in one

=====
# How is it structurate?
MILTF is composed of one entry script (miltf.py) et four folders:
- module: scripts to extract data, manipulate data, wrap the outputs
- output: where are stored output files (option -o/--output txt)
- ressource: IOC/MTGX/TXT examples files; tool banner; whitelist
- store: MILTF configuration file (store/miltf.cfg) and backup file of the Working Base (WB)  generated by the -co/--cache-out argument, named wb.csv

# How does it work?
When launch, MILTF take in the config file the root folder to search IOC and MTGX files. It then search for this kind of file from this root, extract IPv4 and FQDN from each of finded files, then create the Working base in memory.
After that, it take care of the arguments.

# What it does?
Their are four main search type:
- find all files depending of one search axe: IOC, MTGX, IPv4 or Domain
- search an IP or a (part of) FQDN in the WB
- matching a given MTGX or IOC file with the WB
- compare to file to each other

## File matching type
Their are two way MILTF match files to the Working Base:
- check: give for each element (IPv4 or FQDN) of the input file where it can be found in the IOC and MTGX files loaded in the WB
- comparaison: give the number of hit elements beetween the input file and matched Working Base entries

## File output type
Their are three output type:
- (default) var: return result to stdout (from extern script)
- txt: create a txt result file in a CSV format
- term: print the result with a more human readable formatting

## Special arguments
Their are four special options:
- api: search elements in the ThreatRecon knowledge base and if found return the Attribution information (API key to set up in store/miltf.cfg; Free API Threashold: 4req / min)
- exclude: clean the output from domain and IP listed in the configured whitelist file
- cache-in: after building up the Working Base, MILTF save an image of it in a csv file (store/wb.csv)
- cache-out: if a previous cache-in has been done, load the Working base from the cache-in image

=====
# Help
python3 miltf.py -h



=====
# Use Case Example

